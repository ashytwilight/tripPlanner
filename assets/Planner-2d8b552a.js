import{_ as D,u as A,r as _,p as B,h as V,a as H,o as a,c as i,b as t,t as c,d as p,F as f,j as x,f as h,e as w,w as L,m as N,i as S,k as T}from"./index-a6cc49f4.js";import{L as z}from"./LocationMap-92bad5cc.js";const I={class:"py-12 px-4 sm:px-6 lg:px-8"},P={class:"max-w-6xl mx-auto"},E={class:"flex justify-between items-center mb-8"},F={class:"text-4xl font-bold text-gray-900 bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-indigo-600"},J={class:"space-x-4"},O={key:0,class:"text-center py-12"},U={key:1,class:"text-center py-16 bg-white rounded-2xl shadow-md"},$={class:"text-xl text-gray-500 font-medium"},q={key:2,class:"space-y-8"},G={class:"text-2xl font-bold text-gray-900 mb-6 flex items-center"},K={class:"bg-gradient-to-r from-blue-500 to-indigo-500 text-white rounded-full w-8 h-8 flex items-center justify-center mr-3 text-sm"},Q=["onClick"],R={class:"space-y-4"},W={class:"flex justify-end mb-4"},X={class:"text-lg font-semibold text-gray-900 mb-1"},Y={class:"text-sm text-gray-600"},Z={class:"mt-4 mb-4"},tt={class:"flex items-center space-x-4 mt-4"},et=["onChange"],ot=["value","disabled"],st=["onClick"],nt={class:"mt-6 bg-white rounded-xl p-6 shadow-sm"},rt={class:"block text-lg font-semibold text-gray-800 mb-3 flex items-center"},lt=["onUpdate:modelValue","placeholder"],at={__name:"Planner",setup(it){const{t:m}=A(),o=_([]),g=_(!1),y=async()=>{g.value=!0;try{const s=localStorage.getItem("tripData");if(s){const e=JSON.parse(s);if(Array.isArray(e)&&e.length>0){o.value=e.map(l=>({...l,attractions:l.attractions.map(n=>({...n,location:n.location||{lat:n.lat||23.5,lng:n.lng||121}}))}));return}}o.value=[{id:1,attractions:[],notes:""}]}catch(s){console.error("加載行程數據時發生錯誤:",s),o.value=[{id:1,attractions:[],notes:""}]}finally{g.value=!1}};B(o,s=>{localStorage.setItem("tripData",JSON.stringify(s))},{deep:!0}),V(()=>{y()});const k=()=>{const s=Math.max(...o.value.map(e=>e.id),0)+1;o.value.push({id:s,attractions:[],notes:""})},C=s=>{if(o.value.length<=1){alert("至少需要保留一天行程！");return}confirm("確定要刪除這一天的行程嗎？")&&(o.value.splice(s,1),o.value.forEach((e,l)=>{e.id=l+1}))},M=(s,e)=>{if(s>=0&&s<o.value.length){const l=o.value[s];e>=0&&e<l.attractions.length&&l.attractions.splice(e,1)}},j=(s,e,l)=>{if(s===e||e==="")return;const n=parseInt(s),u=parseInt(e);if(n>=0&&n<o.value.length&&u>=0&&u<o.value.length){const r=o.value[n].attractions,v=r.findIndex(d=>d.id===l.id);if(v!==-1){const[d]=r.splice(v,1);o.value[u].attractions.push(d)}}};return(s,e)=>{const l=H("router-link");return a(),i("div",I,[t("div",P,[t("div",E,[t("h1",F,c(p(m)("planner.title")),1),t("div",J,[t("button",{onClick:k,class:"bg-gradient-to-r from-green-400 to-green-600 text-white px-6 py-2.5 rounded-lg font-medium shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50"},c(p(m)("planner.addDay")),1)])]),g.value?(a(),i("div",O,e[0]||(e[0]=[t("div",{class:"animate-spin rounded-full h-16 w-16 border-4 border-blue-500 border-t-transparent mx-auto"},null,-1)]))):o.value.length===0?(a(),i("div",U,[e[1]||(e[1]=t("svg",{class:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)),t("p",$,c(p(m)("planner.empty")),1)])):(a(),i("div",q,[(a(!0),i(f,null,x(o.value,(n,u)=>(a(),i("div",{key:n.id,class:"bg-white rounded-2xl shadow-lg p-8 transform transition-all duration-200 hover:shadow-xl"},[t("h2",G,[t("span",K,c(n.id),1),h(" "+c(p(m)("planner.day",{n:n.id}))+" ",1),t("button",{onClick:r=>C(u),class:"ml-auto flex items-center px-3 py-1 text-red-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors duration-200"},e[2]||(e[2]=[t("svg",{class:"w-5 h-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),h(" 刪除 ")]),8,Q)]),t("div",R,[t("div",W,[w(l,{to:{path:"/search",query:{day:n.id}},class:"flex items-center px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors"},{default:L(()=>e[3]||(e[3]=[t("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),h(" 新增景點 ")])),_:2},1032,["to"])]),(a(!0),i(f,null,x(n.attractions,(r,v)=>(a(),i("div",{key:r.id,class:"bg-gradient-to-r from-gray-50 to-gray-100 p-6 rounded-xl transition-all duration-200 hover:shadow-md"},[t("div",null,[t("h3",X,c(r.name),1),t("p",Y,c(r.city),1)]),t("div",Z,[w(z,{latitude:r.location.lat,longitude:r.location.lng,height:"200px",zoom:16},null,8,["latitude","longitude"])]),t("div",tt,[o.value.length>1?(a(),i("select",{key:0,class:"bg-white border border-gray-300 rounded-lg px-4 py-2 text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",onChange:d=>j(u,d.target.value,r)},[e[4]||(e[4]=t("option",{value:""},"移動到...",-1)),(a(!0),i(f,null,x(o.value,(d,b)=>(a(),i("option",{key:d.id,value:b,disabled:b===u}," 第 "+c(d.id)+" 天 ",9,ot))),128))],40,et)):N("",!0),t("button",{onClick:d=>M(u,v),class:"flex items-center px-4 py-2 text-red-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors duration-200"},e[5]||(e[5]=[t("svg",{class:"w-5 h-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),h(" 刪除 ")]),8,st)])]))),128)),t("div",nt,[t("label",rt,[e[6]||(e[6]=t("svg",{class:"w-5 h-5 mr-2 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)),h(" "+c(p(m)("planner.notes")),1)]),S(t("textarea",{"onUpdate:modelValue":r=>n.notes=r,rows:"4",class:"w-full border-2 border-gray-200 rounded-lg p-4 text-gray-700 focus:outline-none focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50 transition-all duration-200 resize-none",placeholder:"在這裡添加第"+n.id+"天的行程備註..."},null,8,lt),[[T,n.notes]])])])]))),128))]))])])}}},ut=D(at,[["__file","Planner.vue"]]);export{ut as default};
