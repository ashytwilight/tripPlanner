import{_ as A,b as D,h as b,s as B,j as V,r as H,o as d,c,d as e,t as r,e as u,F as x,l as f,g as h,f as w,w as L,q as N,k as S,m as P}from"./index-b84b5f63.js";import{L as T}from"./LocationMap-0801140f.js";const z={class:"py-12 px-4 sm:px-6 lg:px-8"},I={class:"max-w-6xl mx-auto"},q={class:"flex justify-between items-center mb-8 px-6"},E={class:"text-3xl font-bold text-gray-900 bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-indigo-600"},F={class:"space-x-4"},J={key:0,class:"text-center py-12"},O={key:1,class:"text-center py-16 bg-white rounded-2xl shadow-md"},U={class:"text-xl text-gray-500 font-medium"},$={key:2,class:"space-y-8"},G={class:"text-xl font-bold text-gray-900 mb-6 flex items-center"},K={class:"bg-gradient-to-r from-blue-500 to-indigo-500 text-white rounded-full w-7 h-7 flex items-center justify-center mr-3 text-sm"},Q=["onClick"],R={class:"space-y-4"},W={class:"flex justify-end mb-4"},X={class:"text-lg font-semibold text-gray-900 mb-1"},Y={class:"mt-4 mb-4"},Z={class:"flex items-center space-x-4 mt-4"},ee=["onChange"],te={value:""},oe=["value","disabled"],ne=["onClick"],se={class:"mt-6 bg-white rounded-xl p-6 shadow-sm"},re={class:"text-lg font-semibold text-gray-800 mb-3 flex items-center"},le=["onUpdate:modelValue","placeholder"],ae={__name:"Planner",setup(ie){const{t:l}=D(),o=b([]),g=b(!1),y=async()=>{g.value=!0;try{const n=localStorage.getItem("tripData");if(n){const t=JSON.parse(n);if(Array.isArray(t)&&t.length>0){o.value=t.map(a=>({...a,attractions:a.attractions.map(s=>({...s,location:s.location||{lat:s.lat||23.5,lng:s.lng||121}}))}));return}}o.value=[{id:1,attractions:[],notes:""}]}catch(n){console.error("加載行程數據時發生錯誤:",n),o.value=[{id:1,attractions:[],notes:""}]}finally{g.value=!1}};B(o,n=>{localStorage.setItem("tripData",JSON.stringify(n))},{deep:!0}),V(()=>{y()});const k=()=>{const n=Math.max(...o.value.map(t=>t.id),0)+1;o.value.push({id:n,attractions:[],notes:""})},C=n=>{if(o.value.length<=1){alert("至少需要保留一天行程！");return}confirm("確定要刪除這一天的行程嗎？")&&(o.value.splice(n,1),o.value.forEach((t,a)=>{t.id=a+1}))},M=(n,t)=>{if(n>=0&&n<o.value.length){const a=o.value[n];t>=0&&t<a.attractions.length&&a.attractions.splice(t,1)}},j=(n,t,a)=>{if(n===t||t==="")return;const s=parseInt(n),m=parseInt(t);if(s>=0&&s<o.value.length&&m>=0&&m<o.value.length){const i=o.value[s].attractions,v=i.findIndex(p=>p.id===a.id);if(v!==-1){const[p]=i.splice(v,1);o.value[m].attractions.push(p)}}};return(n,t)=>{const a=H("router-link");return d(),c("div",z,[e("div",I,[e("div",q,[e("h1",E,r(u(l)("planner.title")),1),e("div",F,[e("button",{onClick:k,class:"bg-gradient-to-r from-green-400 to-green-600 text-white px-6 py-2.5 rounded-lg font-medium shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50"},r(u(l)("planner.addDay")),1)])]),g.value?(d(),c("div",J,t[0]||(t[0]=[e("div",{class:"animate-spin rounded-full h-16 w-16 border-4 border-blue-500 border-t-transparent mx-auto"},null,-1)]))):o.value.length===0?(d(),c("div",O,[t[1]||(t[1]=e("svg",{class:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)),e("p",U,r(u(l)("planner.empty")),1)])):(d(),c("div",$,[(d(!0),c(x,null,f(o.value,(s,m)=>(d(),c("div",{key:s.id,class:"bg-white rounded-2xl shadow-lg p-8 transform transition-all duration-200 hover:shadow-xl"},[e("h2",G,[e("span",K,r(s.id),1),h(" "+r(u(l)("planner.day",{n:s.id}))+" ",1),e("button",{onClick:i=>C(m),class:"ml-auto flex items-center px-3 py-1 text-red-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors duration-200 text-base"},[t[2]||(t[2]=e("svg",{class:"w-5 h-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)),h(" "+r(u(l)("planner.delete")),1)],8,Q)]),e("div",R,[e("div",W,[w(a,{to:{path:"/search",query:{day:s.id}},class:"flex items-center px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm"},{default:L(()=>[t[3]||(t[3]=e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)),h(" "+r(u(l)("planner.addAttraction")),1)]),_:2},1032,["to"])]),(d(!0),c(x,null,f(s.attractions,(i,v)=>(d(),c("div",{key:i.id,class:"bg-gradient-to-r from-gray-50 to-gray-100 p-6 rounded-xl transition-all duration-200 hover:shadow-md"},[e("div",null,[e("h3",X,r(i.name),1)]),e("div",Y,[w(T,{latitude:i.location.lat,longitude:i.location.lng,height:"200px",zoom:16},null,8,["latitude","longitude"])]),e("div",Z,[o.value.length>1?(d(),c("select",{key:0,class:"bg-white border border-gray-300 rounded-lg px-4 py-2 text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",onChange:p=>j(m,p.target.value,i)},[e("option",te,r(u(l)("planner.switch")),1),(d(!0),c(x,null,f(o.value,(p,_)=>(d(),c("option",{key:p.id,value:_,disabled:_===m},r(u(l)("planner.day",{n:p.id})),9,oe))),128))],40,ee)):N("",!0),e("button",{onClick:p=>M(m,v),class:"flex items-center px-4 py-2 text-red-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors duration-200"},[t[4]||(t[4]=e("svg",{class:"w-5 h-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)),h(" "+r(u(l)("planner.delete")),1)],8,ne)])]))),128)),e("div",se,[e("label",re,[t[5]||(t[5]=e("svg",{class:"w-5 h-5 mr-2 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)),h(" "+r(u(l)("planner.notes")),1)]),S(e("textarea",{"onUpdate:modelValue":i=>s.notes=i,rows:"4",class:"w-full border-2 border-gray-200 rounded-lg p-4 text-gray-700 focus:outline-none focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50 transition-all duration-200 resize-none",placeholder:u(l)("planner.textareaPlaceholder",{n:s.id})},null,8,le),[[P,s.notes]])])])]))),128))]))])])}}},ue=A(ae,[["__file","Planner.vue"]]);export{ue as default};
